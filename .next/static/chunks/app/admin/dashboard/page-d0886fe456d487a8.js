(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{16109:(e,s,t)=>{"use strict";t.d(s,{U:()=>r,b:()=>i});var a=t(4246),l=t(55172);t(36941);let n=()=>({schoolName:localStorage.getItem("schoolName")||"School",schoolId:localStorage.getItem("schoolID")||"N/A"}),i=(e,s)=>{let{schoolName:t,schoolId:l}=n(),i=a.Wp.aoa_to_sheet([[t],["(ID: ".concat(l,")")],[]]);if(a.Wp.sheet_add_aoa(i,e,{origin:"A4"}),e[0]&&e[0].length>0){let s={s:{r:0,c:0},e:{r:0,c:e[0].length-1}};i["!merges"]||(i["!merges"]=[]),i["!merges"].push(s);let t={s:{r:1,c:0},e:{r:1,c:e[0].length-1}};i["!merges"].push(t)}let r=e[0].map(()=>({wch:15}));i["!cols"]=r;let c=a.Wp.book_new();a.Wp.book_append_sheet(c,i,"Timetable"),a._h(c,"".concat(s,".xlsx"))},r=(e,s)=>{let{schoolName:t,schoolId:a}=n(),i=new l.Ay({orientation:"landscape"});i.setFontSize(16),i.text(t,i.internal.pageSize.getWidth()/2,15,{align:"center"}),i.setFontSize(10),i.text("(ID: ".concat(a,")"),i.internal.pageSize.getWidth()/2,20,{align:"center"});let r=e.length>0?[e[0].map(e=>e.text)]:[],c=e.length>1?e.slice(1).map(e=>e.map(e=>e.text)):[];i.autoTable({startY:25,head:r,body:c,didParseCell:function(s){let t;"body"===s.section?e[s.row.index+1]&&e[s.row.index+1][s.column.index]&&(t=e[s.row.index+1][s.column.index]):"head"===s.section&&e[s.row.index]&&e[s.row.index][s.column.index]&&(t=e[s.row.index][s.column.index]),(null==t?void 0:t.color)==="FF0000"&&(s.cell.styles.textColor="#FF0000")},styles:{fontSize:6,cellPadding:2,overflow:"linebreak",fontStyle:"bold",halign:"center",valign:"middle"},headStyles:{fillColor:[220,220,220],textColor:[0,0,0],fontSize:7,fontStyle:"bold",halign:"center",valign:"middle"},alternateRowStyles:{fillColor:[245,245,245]}}),i.save("".concat(s,".pdf"))}},32809:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_});var a=t(95155),l=t(12115),n=t(20063),i=t(79943),r=t(97003),c=t(33789),d=t(83209),o=t(96633),h=t(54679),m=t(28171),x=t(42529),u=t(78874),p=t(29502),g=t(17910),j=t(84926),f=t(91169),y=t(91761),v=t(85998),N=t(37586),b=t(72372),S=t(15870),w=t(24722),C=t(89715),A=t(96583),I=t(11010),D=t(71360),k=t(23061),P=t(403),F=t(54690),R=t(29633),M=t(55867),T=t(52056),B=t(27346),E=t(90923),J=t(67001),Z=t(90235),$=t(25016),z=t(91163),L=t(92381),O=t(67812),W=t(15239),U=t(32559),G=t(16109);function _(){let{isAdmin:e,logout:s,isLoading:t,getSchools:_,setSchools:X,getAdminCredentials:H,setAdminCredentials:Y}=(0,i.A)(),Q=(0,n.useRouter)(),{toast:q}=(0,m.dj)(),[K,V]=(0,l.useState)([]),[ee,es]=(0,l.useState)([]),[et,ea]=(0,l.useState)(!1),[el,en]=(0,l.useState)("add"),[ei,er]=(0,l.useState)(null),[ec,ed]=(0,l.useState)(""),[eo,eh]=(0,l.useState)(""),[em,ex]=(0,l.useState)(""),[eu,ep]=(0,l.useState)(null),[eg,ej]=(0,l.useState)([]),[ef,ey]=(0,l.useState)([]),[ev,eN]=(0,l.useState)(""),[eb,eS]=(0,l.useState)(""),[ew,eC]=(0,l.useState)(!1),[eA,eI]=(0,l.useState)(null),[eD,ek]=(0,l.useState)(""),[eP,eF]=(0,l.useState)({monthly:{name:"Monthly",price:""},halfYearly:{name:"Half-Yearly",price:""},annually:{name:"Annually",price:""}}),[eR,eM]=(0,l.useState)(null),eT=(0,l.useRef)(null),[eB,eE]=(0,l.useState)("30"),[eJ,eZ]=(0,l.useState)(""),[e$,ez]=(0,l.useState)(""),[eL,eO]=(0,l.useState)(!1),[eW,eU]=(0,l.useState)(null),eG=(0,l.useCallback)(e=>{let s=new Date;if(e.subscriptionEndDate){let t=new Date(e.subscriptionEndDate);return t>=s?{text:"Active until ".concat((0,z.GP)(t,"dd MMM yyyy")),icon:x.A,color:"text-green-600"}:{text:"Expired on ".concat((0,z.GP)(t,"dd MMM yyyy")),icon:u.A,color:"text-destructive"}}if(e.signupDate){let t=(0,L.f)(new Date(e.signupDate),parseInt(eB,10));return t>=s?{text:"Trial ends ".concat((0,z.GP)(t,"dd MMM yyyy")),icon:p.A,color:"text-amber-600"}:{text:"Trial expired",icon:u.A,color:"text-destructive"}}return{text:"No active subscription",icon:u.A,color:"text-destructive"}},[eB]),e_=(0,l.useCallback)(()=>{V(_());try{let e=localStorage.getItem("loginLogs");es(e?JSON.parse(e):[]);let s=localStorage.getItem("adminAnnouncement");s&&ep(JSON.parse(s));let t=H();eN(t.id),eS(t.password||"");let a=localStorage.getItem("subscriptionPlans");a&&eF(JSON.parse(a));let l=localStorage.getItem("pendingSubscriptions");ej(l?JSON.parse(l):[]);let n=localStorage.getItem("paymentQRCode");n&&eM(n);let i=localStorage.getItem("supportMessages");ey(i?JSON.parse(i):[]);let r=localStorage.getItem("trialPeriodDays");eE(r||"30");let c=localStorage.getItem("paymentGatewayConfig");if(c){let e=JSON.parse(c);eZ(e.appId||""),ez(e.secretKey||"")}}catch(e){console.error("Error loading admin data from localStorage",e)}},[_,H]);(0,l.useEffect)(()=>{t||e?e&&e_():Q.push("/")},[e,t,Q,e_]);let eX=(e,s)=>{en(e),"edit"===e&&s?(er(s),ed(s.name),eh(s.id)):(er(null),ed(""),eh("")),ea(!0)},eH=(e,s)=>{eF(t=>({...t,[e]:{...t[e],price:s}}))},eY=e=>{eI(e),ek(e.subscriptionEndDate?(0,z.GP)(new Date(e.subscriptionEndDate),"yyyy-MM-dd"):""),eC(!0)},eQ=e=>{let s=["S.No.","School Name","School ID","Signup Date","Subscription Status"],t=K.map((e,s)=>{let t=eG(e),a=e.signupDate?(0,z.GP)(new Date(e.signupDate),"dd MMM yyyy"):"N/A";return[String(s+1),e.name,e.id,a,t.text]}),a=[s,...t],l=[s.map(e=>({text:e,bold:!0})),...t.map(e=>e.map(e=>({text:e})))];"excel"===e?(0,G.b)(a,"Registered_Schools"):(0,G.U)(l,"Registered_Schools")};return t||!e?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,a.jsx)("p",{children:"Loading..."})}):(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground p-4 sm:p-6 lg:p-8",children:[(0,a.jsxs)("main",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-primary flex items-center gap-2",children:[(0,a.jsx)(g.A,{})," Admin Dashboard"]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage schools, view system activity, and broadcast messages."})]}),(0,a.jsxs)(r.$,{onClick:()=>s(),variant:"outline",className:"mt-4 sm:mt-0",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Logout"]})]}),(0,a.jsxs)(E.tU,{defaultValue:"users",className:"w-full",children:[(0,a.jsxs)(E.j7,{className:"grid w-full grid-cols-2 sm:grid-cols-3 lg:grid-cols-6",children:[(0,a.jsxs)(E.Xi,{value:"users",children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"User Management"]}),(0,a.jsxs)(E.Xi,{value:"subscriptions",children:[(0,a.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Subscriptions"]}),(0,a.jsxs)(E.Xi,{value:"pending",children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Pending",eg.length>0&&(0,a.jsx)(O.E,{className:"ml-2",children:eg.length})]}),(0,a.jsxs)(E.Xi,{value:"support",children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Support",ef.length>0&&(0,a.jsx)(O.E,{className:"ml-2",children:ef.length})]}),(0,a.jsxs)(E.Xi,{value:"logs",children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4"}),"Login Logs"]}),(0,a.jsxs)(E.Xi,{value:"settings",children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Settings"]})]}),(0,a.jsx)(E.av,{value:"users",className:"mt-6",children:(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,a.jsxs)("div",{className:"mb-4 sm:mb-0",children:[(0,a.jsx)(d.ZB,{children:"Registered Schools"}),(0,a.jsx)(d.BT,{children:"View, edit, or delete school accounts."})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(r.$,{onClick:()=>eQ("excel"),variant:"outline",size:"sm",children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"})," Export Excel"]}),(0,a.jsxs)(r.$,{onClick:()=>eQ("pdf"),variant:"outline",size:"sm",children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"})," Export PDF"]}),(0,a.jsxs)(r.$,{onClick:()=>eX("add"),size:"sm",children:[(0,a.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Add School"]})]})]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(B.F,{className:"h-[60vh] w-full",children:[(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"School Name"}),(0,a.jsx)(o.nd,{className:"hidden sm:table-cell",children:"School ID"}),(0,a.jsx)(o.nd,{className:"hidden md:table-cell",children:"Signup Date"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:K.map(e=>(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{className:"font-medium",children:e.name}),(0,a.jsx)(o.nA,{className:"hidden sm:table-cell",children:e.id}),(0,a.jsx)(o.nA,{className:"hidden md:table-cell",children:e.signupDate?(0,z.GP)(new Date(e.signupDate),"dd MMM yyyy"):"N/A"}),(0,a.jsxs)(o.nA,{className:"text-right space-x-2",children:[(0,a.jsx)(r.$,{variant:"ghost",size:"icon",onClick:()=>eX("edit",e),children:(0,a.jsx)(I.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"ghost",size:"icon",onClick:()=>(e=>{X(_().filter(s=>s.id!==e.id));try{["teacherData","subjects","scheduleSettings","classesAndSections","resolvedTimetable"].forEach(s=>{localStorage.removeItem("".concat(e.id,"-").concat(s))})}catch(e){console.error("Could not clean up all local storage for deleted school",e)}e_(),q({title:'School "'.concat(e.name,'" deleted.')})})(e),children:(0,a.jsx)(D.A,{className:"h-4 w-4 text-destructive"})})]})]},e.id))})]}),0===K.length&&(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No schools registered yet."})]})})]})}),(0,a.jsx)(E.av,{value:"subscriptions",className:"mt-6",children:(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"School Subscriptions"}),(0,a.jsx)(d.BT,{children:"Manage trial periods and subscription statuses for all schools."})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(B.F,{className:"h-[60vh] w-full",children:[(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"School Name"}),(0,a.jsx)(o.nd,{children:"Subscription Status"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:K.map(e=>{let s=eG(e);return(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{className:"font-medium",children:e.name}),(0,a.jsxs)(o.nA,{className:(0,$.cn)("flex items-center gap-2",s.color),children:[(0,a.jsx)(s.icon,{className:"h-4 w-4"})," ",s.text]}),(0,a.jsx)(o.nA,{className:"text-right",children:(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>eY(e),children:"Manage"})})]},e.id)})})]}),0===K.length&&(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No schools to manage."})]})})]})}),(0,a.jsx)(E.av,{value:"pending",className:"mt-6",children:(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Pending Subscription Requests"}),(0,a.jsx)(d.BT,{children:"Review and approve subscription requests after payment verification."})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(B.F,{className:"h-[60vh] w-full",children:[(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"School"}),(0,a.jsx)(o.nd,{className:"hidden md:table-cell",children:"Plan"}),(0,a.jsx)(o.nd,{children:"Payment Proof"}),(0,a.jsx)(o.nd,{className:"hidden lg:table-cell",children:"Timestamp"}),(0,a.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(o.BF,{children:eg.map(e=>{var s,t;return(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{children:(s=e.schoolId,(null==(t=K.find(e=>e.id===s))?void 0:t.name)||s)}),(0,a.jsx)(o.nA,{className:"hidden md:table-cell",children:e.planName}),(0,a.jsx)(o.nA,{children:(0,a.jsxs)(r.$,{variant:"link",size:"sm",className:"p-0 h-auto",onClick:()=>{eU(e.paymentScreenshot),eO(!0)},children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-1"})," View"]})}),(0,a.jsx)(o.nA,{className:"hidden lg:table-cell",children:new Date(e.timestamp).toLocaleString()}),(0,a.jsxs)(o.nA,{className:"text-right space-x-2",children:[(0,a.jsx)(r.$,{variant:"secondary",size:"sm",onClick:()=>(e=>{let s=K.find(s=>s.id===e.schoolId);if(s){let t=eg.filter(s=>s.timestamp!==e.timestamp);ej(t),localStorage.setItem("pendingSubscriptions",JSON.stringify(t)),eY(s)}else q({title:"School not found",variant:"destructive"})})(e),children:"Approve"}),(0,a.jsx)(r.$,{variant:"destructive",size:"sm",onClick:()=>(e=>{let s=eg.filter(s=>s.timestamp!==e.timestamp);ej(s),localStorage.setItem("pendingSubscriptions",JSON.stringify(s)),q({title:"Subscription request rejected."})})(e),children:"Reject"})]})]},e.timestamp)})})]}),0===eg.length&&(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No pending requests."})]})})]})}),(0,a.jsx)(E.av,{value:"support",className:"mt-6",children:(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Support Messages"}),(0,a.jsx)(d.BT,{children:"View and manage incoming messages from users."})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)(B.F,{className:"h-[60vh] w-full",children:ef.length>0?(0,a.jsx)("div",{className:"space-y-4",children:ef.map(e=>(0,a.jsxs)(d.Zp,{className:"bg-muted/50",children:[(0,a.jsxs)(d.aR,{className:"p-4 flex-row justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ZB,{className:"text-base",children:e.subject}),(0,a.jsxs)(d.BT,{className:"text-xs mt-1",children:["From: ",e.schoolId||"Anonymous"," | Received: ",new Date(e.timestamp).toLocaleString()]})]}),(0,a.jsx)(r.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>(e=>{let s=ef.filter(s=>s.id!==e);ey(s),localStorage.setItem("supportMessages",JSON.stringify(s)),q({title:"Support message deleted."})})(e.id),children:(0,a.jsx)(D.A,{className:"h-4 w-4 text-destructive"})})]}),(0,a.jsx)(d.Wu,{className:"p-4 pt-0",children:(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.message})})]},e.id))}):(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No support messages."})})})]})}),(0,a.jsx)(E.av,{value:"logs",className:"mt-6",children:(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"User Login Activity"}),(0,a.jsx)(d.BT,{children:"A log of the most recent school sign-ins."})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(B.F,{className:"h-[60vh] w-full",children:[(0,a.jsxs)(o.XI,{children:[(0,a.jsx)(o.A0,{children:(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nd,{children:"School Name"}),(0,a.jsx)(o.nd,{className:"hidden sm:table-cell",children:"School ID"}),(0,a.jsx)(o.nd,{children:"Timestamp"})]})}),(0,a.jsx)(o.BF,{children:ee.map((e,s)=>(0,a.jsxs)(o.Hj,{children:[(0,a.jsx)(o.nA,{children:e.schoolName}),(0,a.jsx)(o.nA,{className:"hidden sm:table-cell",children:e.schoolId}),(0,a.jsx)(o.nA,{children:new Date(e.timestamp).toLocaleString()})]},"".concat(e.schoolId,"-").concat(e.timestamp,"-").concat(s)))})]}),0===ee.length&&(0,a.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No login activity recorded yet."})]})})]})}),(0,a.jsxs)(E.av,{value:"settings",className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(P.A,{})," Broadcast Message"]}),(0,a.jsx)(d.BT,{children:"Post an announcement that will be visible to all users on their dashboard."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[eu&&(0,a.jsxs)("div",{className:"p-4 bg-muted rounded-lg border",children:[(0,a.jsx)("p",{className:"text-sm font-semibold",children:"Current Announcement:"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:eu.message}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground/70 mt-2",children:["Posted on: ",new Date(eu.timestamp).toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"announcement",className:"sr-only",children:"New Announcement"}),(0,a.jsx)(J.T,{id:"announcement",placeholder:"Type your announcement here...",value:em,onChange:e=>ex(e.target.value),rows:3})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(r.$,{onClick:()=>{if(!em.trim())return void q({title:"Announcement message cannot be empty.",variant:"destructive"});let e={message:em.trim(),timestamp:new Date().toISOString()};try{localStorage.setItem("adminAnnouncement",JSON.stringify(e)),ep(e),q({title:"Announcement published successfully!"}),ex("")}catch(e){q({title:"Failed to publish announcement.",variant:"destructive"})}},className:"flex-grow",children:eu?"Update Announcement":"Publish Announcement"}),eu&&(0,a.jsx)(r.$,{onClick:()=>{try{localStorage.removeItem("adminAnnouncement"),ep(null),q({title:"Announcement cleared."})}catch(e){q({title:"Failed to clear announcement.",variant:"destructive"})}},variant:"destructive",className:"flex-grow",children:"Clear Announcement"})]})]})]}),(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Admin Credentials"}),(0,a.jsx)(d.BT,{children:"Change the username and password for the admin account."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"adminId",children:"Admin ID"}),(0,a.jsx)(c.p,{id:"adminId",value:ev,onChange:e=>eN(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"adminPassword",children:"Admin Password"}),(0,a.jsx)(c.p,{id:"adminPassword",type:"password",value:eb,onChange:e=>eS(e.target.value)})]}),(0,a.jsx)(r.$,{onClick:()=>{if(!ev.trim()||!eb.trim())return void q({title:"Admin ID and Password cannot be empty.",variant:"destructive"});Y({id:ev.trim(),password:eb.trim()}),q({title:"Admin credentials updated successfully."})},children:"Save Credentials"})]})]}),(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(F.A,{})," Payment QR Code"]}),(0,a.jsx)(d.BT,{children:"Upload the QR code image that users will see for manual payment."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[eR&&(0,a.jsx)("div",{className:"p-2 border rounded-md bg-white inline-block",children:(0,a.jsx)(W.default,{src:eR,alt:"QR Code Preview",width:150,height:150})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"qrCodeFile",children:"Upload New QR Code"}),(0,a.jsx)(c.p,{id:"qrCodeFile",type:"file",accept:"image/*",ref:eT,onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){let e=new FileReader;e.onloadend=()=>{eM(e.result)},e.readAsDataURL(t)}}})]}),(0,a.jsx)(r.$,{onClick:()=>{eR?(localStorage.setItem("paymentQRCode",eR),q({title:"QR Code saved successfully."})):q({title:"No QR Code to save.",variant:"destructive"})},children:"Save QR Code"})]})]}),(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsx)(d.ZB,{children:"Subscription Plans"}),(0,a.jsx)(d.BT,{children:"Set the prices for your subscription plans. This is for display purposes."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"monthlyPrice",children:"Monthly Price"}),(0,a.jsx)(c.p,{id:"monthlyPrice",placeholder:"e.g., 10",value:eP.monthly.price,onChange:e=>eH("monthly",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"halfYearlyPrice",children:"Half-Yearly Price"}),(0,a.jsx)(c.p,{id:"halfYearlyPrice",placeholder:"e.g., 50",value:eP.halfYearly.price,onChange:e=>eH("halfYearly",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"annuallyPrice",children:"Annual Price"}),(0,a.jsx)(c.p,{id:"annuallyPrice",placeholder:"e.g., 90",value:eP.annually.price,onChange:e=>eH("annually",e.target.value)})]})]}),(0,a.jsx)(r.$,{onClick:()=>{localStorage.setItem("subscriptionPlans",JSON.stringify(eP)),q({title:"Subscription plans saved."})},children:"Save Plans"})]})]}),(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(R.A,{})," Trial Period"]}),(0,a.jsx)(d.BT,{children:"Set the number of free trial days for new schools."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"trialDays",children:"Trial Days"}),(0,a.jsx)(c.p,{id:"trialDays",type:"number",value:eB,onChange:e=>eE(e.target.value)})]}),(0,a.jsx)(r.$,{onClick:()=>{let e=parseInt(eB,10);if(isNaN(e)||e<0)return void q({title:"Invalid number of days",variant:"destructive"});localStorage.setItem("trialPeriodDays",String(e)),q({title:"Trial period updated successfully."})},children:"Save Trial Period"})]})]}),(0,a.jsxs)(d.Zp,{className:"bg-card",children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(M.A,{})," Payment Gateway (Future Use)"]}),(0,a.jsx)(d.BT,{children:"Configure API keys for a future backend integration."})]}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)(U.Fc,{variant:"destructive",children:[(0,a.jsx)(T.A,{className:"h-4 w-4"}),(0,a.jsx)(U.XL,{children:"Security Warning"}),(0,a.jsx)(U.TN,{children:"This is a placeholder and is NOT functional. Do NOT enter real secret keys here. A secure backend (like Firebase Cloud Functions) is required to use these keys safely."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"gatewayAppId",children:"Cashfree App ID (Public)"}),(0,a.jsx)(c.p,{id:"gatewayAppId",placeholder:"Enter your App ID",value:eJ,onChange:e=>eZ(e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{htmlFor:"gatewaySecretKey",children:"Cashfree Secret Key (Private)"}),(0,a.jsx)(c.p,{id:"gatewaySecretKey",type:"password",placeholder:"Enter your Secret Key",value:e$,onChange:e=>ez(e.target.value)})]}),(0,a.jsx)(r.$,{onClick:()=>{localStorage.setItem("paymentGatewayConfig",JSON.stringify({appId:eJ,secretKey:e$})),q({title:"Payment gateway settings saved.",description:"This is a placeholder and is not yet functional."})},children:"Save Configuration"})]})]})]})]})]}),(0,a.jsx)(h.lG,{open:et,onOpenChange:ea,children:(0,a.jsxs)(h.Cf,{children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:"add"===el?"Add New School":"Edit School"}),(0,a.jsx)(h.rr,{children:"add"===el?"Create a new school account with a ".concat(eB,"-day trial."):"Update the details for this school."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"schoolName",children:"School Name"}),(0,a.jsx)(c.p,{id:"schoolName",value:ec,onChange:e=>ed(e.target.value),placeholder:"e.g., Springfield Elementary"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"schoolId",children:"School ID"}),(0,a.jsx)(c.p,{id:"schoolId",value:eo,onChange:e=>eh(e.target.value),placeholder:"e.g., SP-ELEM-01"})]})]}),(0,a.jsxs)(h.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>ea(!1),children:"Cancel"}),(0,a.jsx)(r.$,{onClick:()=>{let e;if(!ec.trim()||!eo.trim())return void q({title:"School Name and ID cannot be empty.",variant:"destructive"});let s=_();if("add"===el){if(s.some(e=>e.id.toLowerCase()===eo.trim().toLowerCase()))return void q({title:"School ID already exists.",variant:"destructive"});e=[...s,{name:ec.trim(),id:eo.trim(),signupDate:new Date().toISOString()}],q({title:"School added successfully."})}else{if(!ei)return;if(s.some(e=>e.id.toLowerCase()===eo.trim().toLowerCase()&&e.id!==ei.id))return void q({title:"That School ID is already taken.",variant:"destructive"});e=s.map(e=>e.id===ei.id?{...e,name:ec.trim(),id:eo.trim()}:e),q({title:"School updated successfully."})}X(e),e_(),ea(!1)},children:"Save Changes"})]})]})}),(0,a.jsx)(h.lG,{open:ew,onOpenChange:eC,children:(0,a.jsxs)(h.Cf,{children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:"Manage Subscription"}),(0,a.jsxs)(h.rr,{children:["Update the subscription for ",null==eA?void 0:eA.name,"."]})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Z.J,{htmlFor:"subEndDate",children:"Subscription End Date"}),(0,a.jsx)(c.p,{id:"subEndDate",type:"date",value:eD,onChange:e=>ek(e.target.value)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Select a date to activate or extend the subscription. Clear the date to deactivate."})]}),(0,a.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,a.jsx)(r.$,{variant:"secondary",size:"sm",onClick:()=>ek((0,z.GP)((0,L.f)(new Date,30),"yyyy-MM-dd")),children:"+1 Month"}),(0,a.jsx)(r.$,{variant:"secondary",size:"sm",onClick:()=>ek((0,z.GP)((0,L.f)(new Date,182),"yyyy-MM-dd")),children:"+6 Months"}),(0,a.jsx)(r.$,{variant:"secondary",size:"sm",onClick:()=>ek((0,z.GP)((0,L.f)(new Date,365),"yyyy-MM-dd")),children:"+1 Year"})]})]}),(0,a.jsxs)(h.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>eC(!1),children:"Cancel"}),(0,a.jsx)(r.$,{onClick:()=>{eA&&eD&&(X(K.map(e=>e.id===eA.id?{...e,subscriptionEndDate:eD}:e)),e_(),eC(!1),q({title:"Subscription for ".concat(eA.name," updated.")}))},children:"Update Subscription"})]})]})}),(0,a.jsx)(h.lG,{open:eL,onOpenChange:eO,children:(0,a.jsxs)(h.Cf,{className:"max-w-3xl",children:[(0,a.jsx)(h.c7,{children:(0,a.jsx)(h.L3,{children:"Payment Screenshot"})}),eW&&(0,a.jsx)("div",{className:"flex justify-center p-4",children:(0,a.jsx)(W.default,{src:eW,alt:"Payment Proof",width:800,height:600,style:{objectFit:"contain"}})})]})})]})}},54679:(e,s,t)=>{"use strict";t.d(s,{Cf:()=>m,Es:()=>u,L3:()=>p,c7:()=>x,lG:()=>c,rr:()=>g,zM:()=>d});var a=t(95155),l=t(12115),n=t(89511),i=t(65229),r=t(25016);let c=n.bL,d=n.l9,o=n.ZL;n.bm;let h=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.hJ,{ref:s,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});h.displayName=n.hJ.displayName;let m=l.forwardRef((e,s)=>{let{className:t,children:l,...c}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(h,{}),(0,a.jsxs)(n.UC,{ref:s,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...c,children:[l,(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.UC.displayName;let x=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};x.displayName="DialogHeader";let u=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};u.displayName="DialogFooter";let p=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.hE,{ref:s,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})});p.displayName=n.hE.displayName;let g=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.VY,{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",t),...l})});g.displayName=n.VY.displayName},67001:(e,s,t)=>{"use strict";t.d(s,{T:()=>i});var a=t(95155),l=t(12115),n=t(25016);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});i.displayName="Textarea"},81850:(e,s,t)=>{Promise.resolve().then(t.bind(t,32809))},90923:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>r});var a=t(95155),l=t(12115),n=t(25667),i=t(25016);let r=n.bL,c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.B8,{ref:s,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});c.displayName=n.B8.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.l9,{ref:s,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});d.displayName=n.l9.displayName;let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.UC,{ref:s,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});o.displayName=n.UC.displayName}},e=>{e.O(0,[524,930,33,545,431,904,229,972,34,810,482,280,228,441,255,358],()=>e(e.s=81850)),_N_E=e.O()}]);