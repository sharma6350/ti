(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{309:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},16109:(e,t,a)=>{"use strict";a.d(t,{U:()=>o,b:()=>l});var r=a(4246),n=a(55172);a(36941);let s=()=>({schoolName:localStorage.getItem("schoolName")||"School",schoolId:localStorage.getItem("schoolID")||"N/A"}),l=(e,t)=>{let{schoolName:a,schoolId:n}=s(),l=r.Wp.aoa_to_sheet([[a],["(ID: ".concat(n,")")],[]]);if(r.Wp.sheet_add_aoa(l,e,{origin:"A4"}),e[0]&&e[0].length>0){let t={s:{r:0,c:0},e:{r:0,c:e[0].length-1}};l["!merges"]||(l["!merges"]=[]),l["!merges"].push(t);let a={s:{r:1,c:0},e:{r:1,c:e[0].length-1}};l["!merges"].push(a)}let o=e[0].map(()=>({wch:15}));l["!cols"]=o;let c=r.Wp.book_new();r.Wp.book_append_sheet(c,l,"Timetable"),r._h(c,"".concat(t,".xlsx"))},o=(e,t)=>{let{schoolName:a,schoolId:r}=s(),l=new n.Ay({orientation:"landscape"});l.setFontSize(16),l.text(a,l.internal.pageSize.getWidth()/2,15,{align:"center"}),l.setFontSize(10),l.text("(ID: ".concat(r,")"),l.internal.pageSize.getWidth()/2,20,{align:"center"});let o=e.length>0?[e[0].map(e=>e.text)]:[],c=e.length>1?e.slice(1).map(e=>e.map(e=>e.text)):[];l.autoTable({startY:25,head:o,body:c,didParseCell:function(t){let a;"body"===t.section?e[t.row.index+1]&&e[t.row.index+1][t.column.index]&&(a=e[t.row.index+1][t.column.index]):"head"===t.section&&e[t.row.index]&&e[t.row.index][t.column.index]&&(a=e[t.row.index][t.column.index]),(null==a?void 0:a.color)==="FF0000"&&(t.cell.styles.textColor="#FF0000")},styles:{fontSize:6,cellPadding:2,overflow:"linebreak",fontStyle:"bold",halign:"center",valign:"middle"},headStyles:{fillColor:[220,220,220],textColor:[0,0,0],fontSize:7,fontStyle:"bold",halign:"center",valign:"middle"},alternateRowStyles:{fillColor:[245,245,245]}}),l.save("".concat(t,".pdf"))}},24017:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var r=a(95155),n=a(12115),s=a(83209),l=a(96633),o=a(52619),c=a.n(o),i=a(97003),d=a(35626),h=a(85871),m=a(309),u=a(24722),x=a(89715),f=a(55239),p=a(16109);let g={Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Sunday:7},b=e=>Object.keys(g).find(t=>g[t]===e),y=e=>{if(!e||0===e.length)return"";let t=[...e].sort((e,t)=>e-t);if(1===t.length)return"(Day: ".concat(t[0],")");let a=[],r=t[0],n=t[0];for(let e=1;e<t.length;e++)t[e]===n+1||(a.push(r===n?"".concat(r):"".concat(r,"-").concat(n)),r=t[e]),n=t[e];return a.push(r===n?"".concat(r):"".concat(r,"-").concat(n)),"(Days: ".concat(a.join(","),")")};function N(){let[e,t]=(0,n.useState)([]),[a,o]=(0,n.useState)(null),[N,j]=(0,n.useState)(""),[w,v]=(0,n.useState)(!1),[k,S]=(0,n.useState)(""),A=(0,n.useCallback)(e=>k?"".concat(k,"-").concat(e):null,[k]);(0,n.useEffect)(()=>{let e=localStorage.getItem("schoolID");e&&S(e);let t=localStorage.getItem("schoolName");t&&j(t)},[]),(0,n.useEffect)(()=>{if(!k)return;let e=A("resolvedTimetable");if(e){let a=localStorage.getItem(e);if(a)try{let e=JSON.parse(a),r=Array.isArray(e)?e:[];t(r),r.length>0&&v(!0)}catch(e){console.error("Failed to parse timetable data",e),t([])}else t([]),v(!1)}let a=A("scheduleSettings");if(a){let e=localStorage.getItem(a);if(e)try{let t=JSON.parse(e);o(t)}catch(e){console.error("Failed to parse schedule settings",e),o(null)}else o(null)}},[k,A]);let T=(0,n.useMemo)(()=>[...new Set(e.map(e=>e.teacher).filter(e=>e&&"Unassigned"!==e&&"N/A"!==e))].sort(),[e]),_=(0,n.useMemo)(()=>(e=>{let t=new Map;if(!e||!e.startTime||!e.periodDuration||!e.totalPeriods||!e.lunchBreakAfter||!e.lunchBreakDuration)return t;let{startTime:a,periodDuration:r,lunchBreakAfter:n,lunchBreakDuration:s,totalPeriods:l}=e;try{let[e,o]=a.split(":").map(Number);if(isNaN(e)||isNaN(o))return new Map;let c=new Date;c.setHours(e,o,0,0);let i=e=>e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}).replace(" ","").toLowerCase(),d=parseInt(n,10),h=parseInt(s,10),m=parseInt(r,10),u=parseInt(l,10);if(isNaN(d)||isNaN(h)||isNaN(m)||isNaN(u))return new Map;for(let e=1;e<=u+1;e++){let a=new Date(c.getTime());if(e===d+1){let r=new Date(a.getTime()+6e4*h);t.set(e,"".concat(i(a),"-").concat(i(r))),c=r}else{let r=new Date(a.getTime()+6e4*m);t.set(e,"".concat(i(a),"-").concat(i(r))),c=r}}}catch(e){return console.error("Error calculating timings:",e),new Map}return t})(a),[a]),{periods:C,relevantDays:I,workingDaysSummary:D,consolidatedTimetable:M}=(0,n.useMemo)(()=>{if(!a||!w)return{periods:[],relevantDays:[],workingDaysSummary:"",consolidatedTimetable:new Map};let t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],r=a.workingDays.sort((e,a)=>t.indexOf(e)-t.indexOf(a)),n=parseInt(a.totalPeriods,10);a.lunchBreakAfter&&parseInt(a.lunchBreakAfter,10)>=0&&n++;let s=Array.from({length:n},(e,t)=>t+1),l=r.map(e=>g[e]).sort((e,t)=>e-t),o="No working days selected.";if(l.length>0)if(1===l.length)o="Showing schedule for ".concat(b(l[0]),".");else{let e=[],t=l[0],a=l[0];for(let r=1;r<l.length;r++)l[r]===a+1||(e.push(t===a?"".concat(b(t)):"".concat(b(t)," - ").concat(b(a))),t=l[r]),a=l[r];e.push(t===a?"".concat(b(t)):"".concat(b(t)," - ").concat(b(a))),o="Showing schedule for ".concat(r.length," working day(s): ").concat(e.join(", "))}let c=new Map;return T.forEach(t=>{let a=new Map;s.forEach(r=>{let n=e.filter(e=>e.teacher===t&&Number(e.period)===r&&"Lunch Break"!==e.subject);if(n.length>0){let e=new Map;n.forEach(t=>{let a="".concat(t.subject,"__").concat(t.class);e.has(a)||e.set(a,[]),e.get(a).push(g[t.day])});let t=[];e.forEach((e,a)=>{let[r,n]=a.split("__");t.push({subject:r,class:n,days:e})}),a.set(r,t)}}),c.set(t,a)}),{periods:s,relevantDays:r,workingDaysSummary:o,consolidatedTimetable:c}},[a,e,T,w]),R=e=>!!a&&!!a.lunchBreakAfter&&e===parseInt(a.lunchBreakAfter,10)+1,B=e=>R(e)?"Lunch":"P".concat((e=>{if(a){let t=parseInt(a.lunchBreakAfter,10);if(isNaN(t))return e;if(e>t)return e-1}return e})(e)),F=t=>e.filter(e=>e.teacher===t&&!R(Number(e.period))).length,E=()=>{let e=[],t=[{text:"S.No.",bold:!0},{text:"Teacher",bold:!0}];return C.forEach(e=>t.push({text:"".concat(B(e),"\n").concat(_.get(e)||""),bold:!0})),t.push({text:"Total Periods",bold:!0}),e.push(t),T.forEach((t,a)=>{let r=[{text:String(a+1)},{text:t,bold:!0}],n=M.get(t);C.forEach(e=>{if(R(e))r.push({text:"Lunch"});else{let t=null==n?void 0:n.get(e);if(t){let e=t.map(e=>"".concat(e.subject,"\n").concat(e.class,"\n").concat(y(e.days))).join("\n\n");r.push({text:e})}else r.push({text:"-"})}}),r.push({text:String(F(t)),bold:!0}),e.push(r)}),e};return(0,r.jsxs)("div",{className:"min-h-screen bg-background text-foreground p-4 sm:p-6 lg:p-8",children:[(0,r.jsx)("style",{children:"\n        @media print {\n          body {\n            background-color: #fff;\n          }\n          .no-print { \n            display: none !important; \n          }\n          #printable-area { \n            position: absolute; \n            left: 0; \n            top: 0; \n            width: 100%;\n            height: auto;\n            overflow: visible;\n          }\n          #printable-area * { \n            visibility: visible; \n          }\n          .printable-table {\n            font-size: 8px;\n          }\n          .printable-table th, .printable-table td {\n            padding: 2px;\n          }\n        }\n      "}),(0,r.jsxs)("main",{className:"max-w-full mx-auto",children:[(0,r.jsxs)("div",{id:"printable-area",children:[(0,r.jsx)(f.A,{schoolName:N,schoolId:k}),(0,r.jsxs)("div",{className:"no-print flex flex-col sm:flex-row justify-between items-center",children:[(0,r.jsx)(i.$,{asChild:!0,variant:"outline",className:"mb-4 sm:mb-0",children:(0,r.jsxs)(c(),{href:"/dashboard",children:[(0,r.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})}),(0,r.jsxs)("nav",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)(i.$,{asChild:!0,variant:"ghost",children:(0,r.jsx)(c(),{href:"/preview",children:"Full View"})}),(0,r.jsx)(i.$,{asChild:!0,variant:"ghost",children:(0,r.jsx)(c(),{href:"/class-timetable",children:"Class View"})}),(0,r.jsx)(i.$,{asChild:!0,variant:"outline",children:(0,r.jsxs)(c(),{href:"/arrangement",children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Arrangement"]})})]})]}),(0,r.jsxs)(s.Zp,{children:[(0,r.jsxs)(s.aR,{children:[(0,r.jsx)(s.ZB,{children:"Teacher-wise Timetable"}),(0,r.jsx)(s.BT,{children:D})]}),(0,r.jsx)(s.Wu,{children:w?(0,r.jsx)("div",{className:"overflow-x-auto printable-table",children:(0,r.jsxs)(l.XI,{children:[(0,r.jsx)(l.A0,{children:(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nd,{className:"w-8 p-1 font-bold text-foreground text-xs sm:text-sm",children:"S.No."}),(0,r.jsx)(l.nd,{className:"sticky left-0 bg-card z-10 p-1 min-w-[150px] font-bold text-foreground text-xs sm:text-sm",children:"Teacher"}),C.map(e=>(0,r.jsxs)(l.nd,{className:"text-center p-1 text-xs font-bold text-foreground",children:[(0,r.jsx)("div",{children:B(e)}),(0,r.jsx)("div",{className:"text-[10px] text-muted-foreground font-normal whitespace-nowrap",children:_.get(e)})]},e)),(0,r.jsx)(l.nd,{className:"text-center p-1 min-w-[80px] font-bold text-foreground text-xs sm:text-sm",children:"Total Periods"})]})}),(0,r.jsx)(l.BF,{children:T.map((e,t)=>(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:"font-medium p-1 text-center text-xs sm:text-sm",children:t+1}),(0,r.jsx)(l.nA,{className:"font-semibold sticky left-0 bg-card z-10 p-2 text-xs sm:text-sm",children:e}),C.map(t=>{var a;let n=null==(a=M.get(e))?void 0:a.get(t);return(0,r.jsx)(l.nA,{className:"text-center p-1",children:R(t)?(0,r.jsx)("span",{className:"text-muted-foreground text-xs font-semibold",children:"Lunch"}):n?(0,r.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-semibold text-xs leading-tight",children:e.subject}),(0,r.jsx)("p",{className:"text-[11px] text-muted-foreground leading-tight",children:e.class}),(0,r.jsx)("p",{className:"text-[10px] text-muted-foreground font-mono",children:y(e.days)})]},"".concat(e.subject,"-").concat(e.class)))}):(0,r.jsx)("span",{className:"text-muted-foreground",children:"-"})},"".concat(e,"-").concat(t))}),(0,r.jsx)(l.nA,{className:"font-medium text-center p-1 text-xs sm:text-sm",children:F(e)})]},e))})]})}):(0,r.jsx)("p",{className:"text-muted-foreground mt-4 text-center py-10",children:"No timetable generated yet. Please generate a timetable from the dashboard."})})]})]}),e.length>0&&(0,r.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row justify-center gap-4 no-print",children:[(0,r.jsxs)(i.$,{onClick:()=>{window.print()},variant:"outline",children:[(0,r.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Print"]}),(0,r.jsxs)(i.$,{onClick:()=>{let e=E().map(e=>e.map(e=>e.text));(0,p.b)(e,"".concat(N,"_Teacher_Timetable"))},variant:"outline",children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Export to Excel"]}),(0,r.jsxs)(i.$,{onClick:()=>{let e=E();(0,p.U)(e,"".concat(N,"_Teacher_Timetable"))},variant:"outline",children:[(0,r.jsx)(x.A,{className:"mr-2 h-4 w-4"})," Export to PDF"]})]})]})]})}},25016:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2821),n=a(75889);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}},32383:()=>{},35626:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},55239:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(95155);let n=e=>{let{schoolName:t,schoolId:a}=e;return(0,r.jsx)("div",{className:"mb-6 text-center",children:(0,r.jsxs)("h1",{className:"text-2xl font-bold text-primary inline-flex items-baseline gap-3",children:[t||"Your School",(0,r.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:["(ID: ",a||"N/A",")"]})]})})}},83209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>i,Wu:()=>d,ZB:()=>c,Zp:()=>l,aR:()=>o});var r=a(95155),n=a(12115),s=a(25016);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});l.displayName="Card";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...n})});o.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});c.displayName="CardTitle";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...n})});i.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...n})});d.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter"},83686:()=>{},85871:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("calendar-cog",[["path",{d:"m15.228 16.852-.923-.383",key:"npixar"}],["path",{d:"m15.228 19.148-.923.383",key:"51cr3n"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"m16.47 14.305.382.923",key:"obybxd"}],["path",{d:"m16.852 20.772-.383.924",key:"dpfhf9"}],["path",{d:"m19.148 15.228.383-.923",key:"1reyyz"}],["path",{d:"m19.53 21.696-.382-.924",key:"1goivc"}],["path",{d:"m20.772 16.852.924-.383",key:"htqkph"}],["path",{d:"m20.772 19.148.924.383",key:"9w9pjp"}],["path",{d:"M21 11V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6",key:"1dju0s"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}]])},96633:(e,t,a)=>{"use strict";a.d(t,{A0:()=>o,BF:()=>c,Hj:()=>i,XI:()=>l,nA:()=>h,nd:()=>d});var r=a(95155),n=a(12115),s=a(25016);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",a),...n})})});l.displayName="Table";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",a),...n})});o.displayName="TableHeader";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",a),...n})});c.displayName="TableBody",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...n})}).displayName="TableFooter";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...n})});i.displayName="TableRow";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...n})});d.displayName="TableHead";let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...n})});h.displayName="TableCell",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",a),...n})}).displayName="TableCaption"},97003:(e,t,a)=>{"use strict";a.d(t,{$:()=>i,r:()=>c});var r=a(95155),n=a(12115),s=a(32467),l=a(83101),o=a(25016);let c=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),i=n.forwardRef((e,t)=>{let{className:a,variant:n,size:l,asChild:i=!1,...d}=e,h=i?s.DX:"button";return(0,r.jsx)(h,{className:(0,o.cn)(c({variant:n,size:l,className:a})),ref:t,...d})});i.displayName="Button"},98228:(e,t,a)=>{Promise.resolve().then(a.bind(a,24017))}},e=>{e.O(0,[524,930,33,545,619,904,441,255,358],()=>e(e.s=98228)),_N_E=e.O()}]);