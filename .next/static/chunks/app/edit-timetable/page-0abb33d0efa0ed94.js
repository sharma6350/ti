(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{25850:(e,t,r)=>{Promise.resolve().then(r.bind(r,90201))},49476:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]])},65229:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},85871:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("calendar-cog",[["path",{d:"m15.228 16.852-.923-.383",key:"npixar"}],["path",{d:"m15.228 19.148-.923.383",key:"51cr3n"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"m16.47 14.305.382.923",key:"obybxd"}],["path",{d:"m16.852 20.772-.383.924",key:"dpfhf9"}],["path",{d:"m19.148 15.228.383-.923",key:"1reyyz"}],["path",{d:"m19.53 21.696-.382-.924",key:"1goivc"}],["path",{d:"m20.772 16.852.924-.383",key:"htqkph"}],["path",{d:"m20.772 19.148.924.383",key:"9w9pjp"}],["path",{d:"M21 11V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h6",key:"1dju0s"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}]])},89511:(e,t,r)=>{"use strict";r.d(t,{G$:()=>H,Hs:()=>v,UC:()=>er,VY:()=>es,ZL:()=>ee,bL:()=>Y,bm:()=>el,hE:()=>ea,hJ:()=>et,l9:()=>Q});var a=r(12115),s=r(92556),l=r(94446),n=r(3468),c=r(68946),i=r(23558),o=r(44831),d=r(69666),u=r(75433),h=r(76842),p=r(97602),m=r(19526),x=r(40101),f=r(97745),g=r(32467),j=r(95155),y="Dialog",[b,v]=(0,n.A)(y),[N,w]=b(y),k=e=>{let{__scopeDialog:t,children:r,open:s,defaultOpen:l,onOpenChange:n,modal:o=!0}=e,d=a.useRef(null),u=a.useRef(null),[h,p]=(0,i.i)({prop:s,defaultProp:null!=l&&l,onChange:n,caller:y});return(0,j.jsx)(N,{scope:t,triggerRef:d,contentRef:u,contentId:(0,c.B)(),titleId:(0,c.B)(),descriptionId:(0,c.B)(),open:h,onOpenChange:p,onOpenToggle:a.useCallback(()=>p(e=>!e),[p]),modal:o,children:r})};k.displayName=y;var C="DialogTrigger",S=a.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,n=w(C,r),c=(0,l.s)(t,n.triggerRef);return(0,j.jsx)(p.sG.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":W(n.open),...a,ref:c,onClick:(0,s.mK)(e.onClick,n.onOpenToggle)})});S.displayName=C;var D="DialogPortal",[A,I]=b(D,{forceMount:void 0}),E=e=>{let{__scopeDialog:t,forceMount:r,children:s,container:l}=e,n=w(D,t);return(0,j.jsx)(A,{scope:t,forceMount:r,children:a.Children.map(s,e=>(0,j.jsx)(h.C,{present:r||n.open,children:(0,j.jsx)(u.Z,{asChild:!0,container:l,children:e})}))})};E.displayName=D;var O="DialogOverlay",T=a.forwardRef((e,t)=>{let r=I(O,e.__scopeDialog),{forceMount:a=r.forceMount,...s}=e,l=w(O,e.__scopeDialog);return l.modal?(0,j.jsx)(h.C,{present:a||l.open,children:(0,j.jsx)(R,{...s,ref:t})}):null});T.displayName=O;var F=(0,g.TL)("DialogOverlay.RemoveScroll"),R=a.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=w(O,r);return(0,j.jsx)(x.A,{as:F,allowPinchZoom:!0,shards:[s.contentRef],children:(0,j.jsx)(p.sG.div,{"data-state":W(s.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),_="DialogContent",P=a.forwardRef((e,t)=>{let r=I(_,e.__scopeDialog),{forceMount:a=r.forceMount,...s}=e,l=w(_,e.__scopeDialog);return(0,j.jsx)(h.C,{present:a||l.open,children:l.modal?(0,j.jsx)(B,{...s,ref:t}):(0,j.jsx)(M,{...s,ref:t})})});P.displayName=_;var B=a.forwardRef((e,t)=>{let r=w(_,e.__scopeDialog),n=a.useRef(null),c=(0,l.s)(t,r.contentRef,n);return a.useEffect(()=>{let e=n.current;if(e)return(0,f.Eq)(e)},[]),(0,j.jsx)(J,{...e,ref:c,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,s.mK)(e.onCloseAutoFocus,e=>{var t;e.preventDefault(),null==(t=r.triggerRef.current)||t.focus()}),onPointerDownOutside:(0,s.mK)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,s.mK)(e.onFocusOutside,e=>e.preventDefault())})}),M=a.forwardRef((e,t)=>{let r=w(_,e.__scopeDialog),s=a.useRef(!1),l=a.useRef(!1);return(0,j.jsx)(J,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var a,n;null==(a=e.onCloseAutoFocus)||a.call(e,t),t.defaultPrevented||(s.current||null==(n=r.triggerRef.current)||n.focus(),t.preventDefault()),s.current=!1,l.current=!1},onInteractOutside:t=>{var a,n;null==(a=e.onInteractOutside)||a.call(e,t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(l.current=!0));let c=t.target;(null==(n=r.triggerRef.current)?void 0:n.contains(c))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&l.current&&t.preventDefault()}})}),J=a.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:n,onCloseAutoFocus:c,...i}=e,u=w(_,r),h=a.useRef(null),p=(0,l.s)(t,h);return(0,m.Oh)(),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.n,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:n,onUnmountAutoFocus:c,children:(0,j.jsx)(o.qW,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":W(u.open),...i,ref:p,onDismiss:()=>u.onOpenChange(!1)})}),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(z,{titleId:u.titleId}),(0,j.jsx)(X,{contentRef:h,descriptionId:u.descriptionId})]})]})}),U="DialogTitle",$=a.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=w(U,r);return(0,j.jsx)(p.sG.h2,{id:s.titleId,...a,ref:t})});$.displayName=U;var q="DialogDescription",L=a.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,s=w(q,r);return(0,j.jsx)(p.sG.p,{id:s.descriptionId,...a,ref:t})});L.displayName=q;var V="DialogClose",G=a.forwardRef((e,t)=>{let{__scopeDialog:r,...a}=e,l=w(V,r);return(0,j.jsx)(p.sG.button,{type:"button",...a,ref:t,onClick:(0,s.mK)(e.onClick,()=>l.onOpenChange(!1))})});function W(e){return e?"open":"closed"}G.displayName=V;var Z="DialogTitleWarning",[H,K]=(0,n.q)(Z,{contentName:_,titleName:U,docsSlug:"dialog"}),z=e=>{let{titleId:t}=e,r=K(Z),s="`".concat(r.contentName,"` requires a `").concat(r.titleName,"` for the component to be accessible for screen reader users.\n\nIf you want to hide the `").concat(r.titleName,"`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/").concat(r.docsSlug);return a.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},X=e=>{let{contentRef:t,descriptionId:r}=e,s=K("DialogDescriptionWarning"),l="Warning: Missing `Description` or `aria-describedby={undefined}` for {".concat(s.contentName,"}.");return a.useEffect(()=>{var e;let a=null==(e=t.current)?void 0:e.getAttribute("aria-describedby");r&&a&&(document.getElementById(r)||console.warn(l))},[l,t,r]),null},Y=k,Q=S,ee=E,et=T,er=P,ea=$,es=L,el=G},90201:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>D});var a=r(95155),s=r(12115),l=r(83209),n=r(96633),c=r(52619),i=r.n(c),o=r(97003),d=r(35626),u=r(91456),h=r(20508),p=r(91169),m=r(85871),x=r(49476),f=r(309),g=r(24722),j=r(89715),y=r(25016),b=r(28171),v=r(54679),N=r(47507),w=r(90235),k=r(55239),C=r(16109),S=r(27346);function D(){let[e,t]=(0,s.useState)([]),[r,c]=(0,s.useState)([]),[D,A]=(0,s.useState)([]),[I,E]=(0,s.useState)([]),[O,T]=(0,s.useState)(new Map),[F,R]=(0,s.useState)(null),[_,P]=(0,s.useState)(!1),[B,M]=(0,s.useState)(null),[J,U]=(0,s.useState)({day:"",class:"",period:1,subject:"",teacher:""}),[$,q]=(0,s.useState)(""),[L,V]=(0,s.useState)(null),{toast:G}=(0,b.dj)(),[W,Z]=(0,s.useState)(""),H=(0,s.useCallback)(e=>W?"".concat(W,"-").concat(e):null,[W]);(0,s.useEffect)(()=>{let e=localStorage.getItem("schoolID");e&&Z(e);let t=localStorage.getItem("schoolName");t&&q(t)},[]),(0,s.useEffect)(()=>{if(!W)return;let e=H("classesAndSections");if(e){let t=localStorage.getItem(e);if(t)try{let e=JSON.parse(t).flatMap(e=>e.sections.map(t=>"".concat(e.name," ").concat(t))).sort();c(e)}catch(e){console.error("Error parsing class data from localStorage",e),c([])}else c([])}let r=H("subjects");if(r){let e=localStorage.getItem(r);if(e)try{let t=JSON.parse(e);A(t.map(e=>e.name).sort())}catch(e){console.error("Error parsing subject data from localStorage",e),A([])}}let a=H("teacherData");if(a){let e=localStorage.getItem(a);if(e)try{let t=JSON.parse(e),r=[...new Set(t.map(e=>e.Name))].sort();E(r)}catch(e){console.error("Error parsing teacher data from localStorage",e),E([])}else E([])}let s=H("resolvedTimetable");if(s){let e=localStorage.getItem(s);if(e)try{let r=JSON.parse(e);t(Array.isArray(r)?r:[])}catch(e){console.error("Error parsing timetable data from localStorage",e),t([])}else t([])}let l=H("scheduleSettings");if(l){let e=localStorage.getItem(l);if(e)try{let t=JSON.parse(e);R(t),T((e=>{let t=new Map;if(!e||!e.startTime||!e.periodDuration||!e.totalPeriods||!e.lunchBreakAfter||!e.lunchBreakDuration)return t;let{startTime:r,periodDuration:a,lunchBreakAfter:s,lunchBreakDuration:l,totalPeriods:n}=e;try{let[e,c]=r.split(":").map(Number);if(isNaN(e)||isNaN(c))return new Map;let i=new Date;i.setHours(e,c,0,0);let o=e=>e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}).replace(" ","").toLowerCase(),d=parseInt(s,10),u=parseInt(l,10),h=parseInt(a,10),p=parseInt(n,10);if(isNaN(d)||isNaN(u)||isNaN(h)||isNaN(p))return new Map;for(let e=1;e<=p+1;e++){let r=new Date(i.getTime());if(e===d+1){let a=new Date(r.getTime()+6e4*u);t.set(e,"".concat(o(r),"-").concat(o(a))),i=a}else{let a=new Date(r.getTime()+6e4*h);t.set(e,"".concat(o(r),"-").concat(o(a))),i=a}}}catch(e){return console.error("Error calculating timings:",e),new Map}return t})(t))}catch(e){console.error("Error parsing schedule settings from localStorage",e),R(null)}else R(null)}},[W,H]);let{periods:K,relevantDays:z}=(0,s.useMemo)(()=>{if(F){let e=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],t=F.workingDays.sort((t,r)=>e.indexOf(t)-e.indexOf(r)),r=parseInt(F.totalPeriods,10);return F.lunchBreakAfter&&parseInt(F.lunchBreakAfter,10)>0&&r++,{periods:Array.from({length:r},(e,t)=>t+1),relevantDays:t}}return{periods:[],relevantDays:[]}},[F]),X=(t,r,a)=>e.find(e=>e.class===t&&e.day===r&&Number(e.period)===a),Y=e=>null!=F&&!!F.lunchBreakAfter&&e===parseInt(F.lunchBreakAfter,10)+1,Q=e=>{if(F){let t=parseInt(F.lunchBreakAfter,10);if(isNaN(t))return e;if(e>t)return e-1}return e},ee=()=>{let e=[],t=[{text:"Class",bold:!0,color:"000000"}];return z.forEach(e=>{K.forEach(r=>{let a=O.get(r)||"",s="".concat(e.substring(0,3),"-").concat(Y(r)?"L":"P".concat(Q(r)),"\n").concat(a);t.push({text:s,bold:!0,color:"000000"})})}),e.push(t),r.forEach(t=>{let r=[{text:t,bold:!0,color:"000000"}];z.forEach(e=>{K.forEach(a=>{if(Y(a))r.push({text:"Lunch Break"});else{let s=X(t,e,a);if(s){let e="Unassigned"===s.teacher,t={text:"".concat(s.subject,"\n").concat(s.teacher),bold:e,color:e?"FF0000":"000000"};r.push(t)}else r.push({text:"-"})}})}),e.push(r)}),e};return(0,a.jsxs)("div",{className:"min-h-screen bg-background text-foreground p-2 sm:p-4 lg:p-6",children:[(0,a.jsx)("style",{children:"\n        @media print {\n          body {\n            background-color: #fff;\n          }\n          .no-print { \n            display: none !important; \n          }\n          #printable-area { \n            position: absolute; \n            left: 0; \n            top: 0; \n            width: 100%;\n            height: auto;\n            overflow: visible;\n          }\n          #printable-area * { \n            visibility: visible; \n          }\n          .printable-table {\n            font-size: 8px;\n          }\n          .printable-table th, .printable-table td {\n            padding: 2px;\n          }\n        }\n      "}),(0,a.jsxs)("main",{className:"w-full mx-auto",children:[(0,a.jsxs)("div",{id:"printable-area",children:[(0,a.jsx)(k.A,{schoolName:$,schoolId:W}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 no-print",children:[(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(i(),{href:"/dashboard",children:[(0,a.jsx)(d.A,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})}),(0,a.jsxs)("nav",{className:"flex flex-col sm:flex-row gap-2 mt-4 sm:mt-0",children:[(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(i(),{href:"/preview",children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Full Preview"]})}),(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(i(),{href:"/teacher-timetable",children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Teacher-wise"]})}),(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(i(),{href:"/class-timetable",children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Class-wise"]})}),(0,a.jsx)(o.$,{asChild:!0,variant:"outline",children:(0,a.jsxs)(i(),{href:"/arrangement",children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"})," Arrangement"]})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-grow lg:w-[calc(100%-18rem)]",children:(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Edit Timetable"}),(0,a.jsx)(l.BT,{children:"Click a cell to edit, or drag a teacher from the list on the right. Changes are saved automatically."})]}),(0,a.jsx)(l.Wu,{children:0===e.length?(0,a.jsx)("div",{className:"text-center py-10",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No timetable data found. Please generate one from the dashboard."})}):(0,a.jsx)("div",{className:"overflow-x-auto printable-table",children:(0,a.jsxs)(n.XI,{children:[(0,a.jsx)(n.A0,{children:(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nd,{className:"w-8 p-1 text-xs font-bold text-foreground",children:"S.No."}),(0,a.jsx)(n.nd,{className:"sticky left-0 bg-card z-10 min-w-[100px] p-1 text-xs font-bold text-foreground",children:"Class"}),z.map(e=>K.map(t=>(0,a.jsxs)(n.nd,{className:"text-center p-1 text-xs font-bold text-foreground",children:[(0,a.jsxs)("div",{className:"whitespace-nowrap",children:[e.substring(0,3),"-",Y(t)?"L":"P".concat(Q(t))]}),(0,a.jsx)("div",{className:"text-[10px] text-muted-foreground font-normal whitespace-nowrap",children:O.get(t)})]},"".concat(e,"-").concat(t))))]})}),(0,a.jsx)(n.BF,{children:r.map((r,s)=>(0,a.jsxs)(n.Hj,{children:[(0,a.jsx)(n.nA,{className:"font-medium p-1 text-center text-xs",children:s+1}),(0,a.jsx)(n.nA,{className:"font-semibold sticky left-0 bg-card z-10 p-1 text-xs",children:r}),z.map(s=>K.map(l=>{let c=X(r,s,l),i=(null==c?void 0:c.teacher)==="Unassigned";return(0,a.jsx)(n.nA,{className:(0,y.cn)("text-center p-1 border",i&&"bg-destructive/20",!Y(l)&&"cursor-pointer hover:bg-muted",L&&"border-dashed border-primary"),onClick:()=>c&&void(!Y(c.period)&&(M(c),U({day:c.day,class:c.class,period:c.period,subject:c.subject,teacher:c.teacher}),P(!0))),onDragOver:e=>e.preventDefault(),onDrop:r=>c&&void(r.preventDefault(),L&&((r,a)=>{if(Y(r.period))return;let s=e.find(e=>e.day===r.day&&e.period===r.period&&e.teacher===a&&"Unassigned"!==a&&e.class!==r.class);if(s)return G({title:"Scheduling Conflict",description:"".concat(a," is already assigned to ").concat(s.class," during this period."),variant:"destructive"});let l=e.map(e=>e.day===r.day&&e.period===r.period&&e.class===r.class?{...e,teacher:a}:e),n=H("resolvedTimetable");n&&(t(l),localStorage.setItem(n,JSON.stringify(l)),G({title:"Timetable updated successfully!"}))})(c,L),V(null)),children:Y(l)?(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"L"}):c?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-xs leading-tight",children:c.subject}),(0,a.jsx)("p",{className:(0,y.cn)("text-[11px] leading-tight",i?"text-destructive font-bold":"text-muted-foreground"),children:c.teacher})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"-"})},"".concat(r,"-").concat(s,"-").concat(l))}))]},r))})]})})})]})}),(0,a.jsx)("div",{className:"w-full lg:w-64 flex-shrink-0 no-print",children:(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{className:"p-4",children:[(0,a.jsx)(l.ZB,{className:"text-lg",children:"Teachers"}),(0,a.jsx)(l.BT,{className:"text-xs",children:"Drag a teacher onto a timetable slot to assign them."})]}),(0,a.jsx)(l.Wu,{className:"p-2",children:(0,a.jsx)(S.F,{className:"h-[60vh] max-h-[calc(100vh-20rem)]",children:(0,a.jsx)("div",{className:"space-y-2",children:["Unassigned",...I].map(e=>(0,a.jsxs)("div",{draggable:!0,onDragStart:()=>{V(e)},className:"flex items-center p-2 border rounded-md cursor-grab active:cursor-grabbing bg-secondary hover:bg-muted",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e})]},e))})})})]})})]})]}),e.length>0&&(0,a.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row justify-center gap-4 no-print",children:[(0,a.jsxs)(o.$,{onClick:()=>{window.print()},variant:"outline",children:[(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4"})," Print"]}),(0,a.jsxs)(o.$,{onClick:()=>{let e=ee().map(e=>e.map(e=>e.text));(0,C.b)(e,"".concat($,"_Editable_Timetable"))},variant:"outline",children:[(0,a.jsx)(g.A,{className:"mr-2 h-4 w-4"})," Export to Excel"]}),(0,a.jsxs)(o.$,{onClick:()=>{let e=ee();(0,C.U)(e,"".concat($,"_Editable_Timetable"))},variant:"outline",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"})," Export to PDF"]})]})]}),(0,a.jsx)(v.lG,{open:_,onOpenChange:P,children:(0,a.jsxs)(v.Cf,{children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsx)(v.L3,{children:"Edit Assignment"}),(0,a.jsx)(v.rr,{children:"Change the details for this period. The system will check for conflicts."})]}),B&&(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(w.J,{htmlFor:"day-select-modal",className:"text-right",children:"Day"}),(0,a.jsxs)(N.l6,{value:J.day,onValueChange:e=>U(t=>({...t,day:e})),children:[(0,a.jsx)(N.bq,{className:"col-span-3",children:(0,a.jsx)(N.yv,{})}),(0,a.jsx)(N.gC,{children:z.map(e=>(0,a.jsx)(N.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(w.J,{htmlFor:"class-select-modal",className:"text-right",children:"Class"}),(0,a.jsxs)(N.l6,{value:J.class,onValueChange:e=>U(t=>({...t,class:e})),children:[(0,a.jsx)(N.bq,{className:"col-span-3",children:(0,a.jsx)(N.yv,{})}),(0,a.jsx)(N.gC,{children:r.map(e=>(0,a.jsx)(N.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(w.J,{htmlFor:"period-select-modal",className:"text-right",children:"Period"}),(0,a.jsxs)(N.l6,{value:String(J.period),onValueChange:e=>U(t=>({...t,period:Number(e)})),children:[(0,a.jsx)(N.bq,{className:"col-span-3",children:(0,a.jsx)(N.yv,{})}),(0,a.jsx)(N.gC,{children:K.filter(e=>!Y(e)).map(e=>(0,a.jsx)(N.eb,{value:String(e),children:"P".concat(Q(e)," (").concat(O.get(e),")")},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(w.J,{htmlFor:"subject-select-modal",className:"text-right",children:"Subject"}),(0,a.jsxs)(N.l6,{value:J.subject,onValueChange:e=>U(t=>({...t,subject:e})),children:[(0,a.jsx)(N.bq,{className:"col-span-3",children:(0,a.jsx)(N.yv,{})}),(0,a.jsx)(N.gC,{children:D.map(e=>(0,a.jsx)(N.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(w.J,{htmlFor:"teacher-select-modal",className:"text-right",children:"Teacher"}),(0,a.jsxs)(N.l6,{value:J.teacher,onValueChange:e=>U(t=>({...t,teacher:e})),children:[(0,a.jsx)(N.bq,{className:"col-span-3",children:(0,a.jsx)(N.yv,{})}),(0,a.jsxs)(N.gC,{children:[(0,a.jsx)(N.eb,{value:"Unassigned",children:"Unassigned"}),I.map(e=>(0,a.jsx)(N.eb,{value:e,children:e},e))]})]})]})]}),(0,a.jsxs)(v.Es,{children:[(0,a.jsx)(o.$,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),(0,a.jsx)(o.$,{onClick:()=>{if(!B||!J.teacher||!J.subject)return;let{day:r,class:a,period:s,subject:l,teacher:n}=J,c=e.find(e=>e.day===r&&e.period===s&&e.teacher===n&&"Unassigned"!==n&&(e.class!==B.class||e.period!==B.period||e.day!==B.day));if(c)return void G({title:"Teacher Conflict",description:"".concat(n," is already assigned to ").concat(c.class," at this time."),variant:"destructive"});if(e.find(e=>e.day===r&&e.period===s&&e.class===a&&(e.class!==B.class||e.period!==B.period||e.day!==B.day)))return void G({title:"Class Conflict",description:"".concat(a," already has a subject scheduled at this time."),variant:"destructive"});let i=e.map(e=>e.class===B.class&&e.day===B.day&&e.period===B.period?{...e,day:r,class:a,period:s,subject:l,teacher:n}:e),o=H("resolvedTimetable");o&&(t(i),localStorage.setItem(o,JSON.stringify(i)),G({title:"Timetable updated successfully!"})),P(!1),M(null)},children:"Save Changes"})]})]})})]})}},91456:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]])}},e=>{e.O(0,[524,930,33,545,619,431,904,229,972,34,896,435,441,255,358],()=>e(e.s=25850)),_N_E=e.O()}]);